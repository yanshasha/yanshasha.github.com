---
layout: post
title: "高性能javascript笔记：第2章 数据访问"
description: ""
category: js
tags: [Javascript]
---
{% include JB/setup %}

##第2章 数据访问

Javascript中有四种基本的数据存取位置：
**直接量**
直接量只代表自身，不存储在特定位置。包括：字符串，数字，布尔值，对象，数组，函数，正则表达式，以及特殊的null和undefined值。

**变量**
开发人员用关键字var自定的数据存储单元。

**数组元素**
存储在Javascript数组对象内部，以数字作为索引。

**对象成员**
存储在Javascript对象内部，以字符串作为索引。


###2.1 管理作用域
**作用域链和标识符解析**
如果名字相同的两个变量存在于作用域链的不同部分，那么标识符就是遍历作用域链时最先找到的那个，也就是说，第一个变量遮蔽了第二个。

**闭包、作用域和内存**
闭包是Javascript最强大的特性之一，它允许函数访问局部作用域之外的数据。

通常来说，函数的活动对象会随同运行期上下文一同销毁。但引入闭包时，由于引用仍然存在于闭包的`[scope]`属性中，因此激活对象无法被销毁。这意味着脚本中的闭包和非闭包函数相比，需要更多的内存开销。

###2.2 对象成员
对象成员包括属性和方法。当一个被命名的成员引用了一个函数，该成员就被称为一个“方法”，相反，引用了非函数类型的成员就被称为“属性”。
**原型**
对象可以有两种成员类型：实例成员（也成为“own”成员）和原型成员。实例成员存在于对象实例中，原型成员则由对象原型继承而来。

用hasOwnProperty()方法可以判断对象是否包含特定的实例成员（传递给方法的参数名及成员的名称），要确定对象是否包含特定的属性，可以使用in操作符。

**嵌套成员**
由于对象成员可能包含其他成员，例如不太常见的写法：window.location.href。每次遇到点操作符，嵌套成员会导致Javascript引擎搜索所有对象成员。执行location.href总是比window.location.href要快。
>大部分浏览器中，点表示法（`object.name`）操作和通过括号表示法（`object["name"]`）无明显区别。

**缓存对象成员值**
通常来说，在函数中如果要多次读取同一个对象属性，最佳做法是将属性值保存到局部变量中。局部变量能用来替代属性以避免多次查找带来的性能开销，特别是在处理嵌套对象成员时。

不要在同一个函数里多次查找同一个对象成员，除非它的值变了。
>这种技术不适用于对象的方法。许多对象方法使用this来判断执行上下文，把一个方法保存在局部变量会导致this绑定到window。改变this的值导致程序出错。


1.访问直接量和局部变量的速度最快，相反，访问数组元素和对象成员相对较慢。
2.由于局部变量存在于作用域链的起始位置，因此访问局部变量比访问跨作用域变量更快。变量在作用域链中的位置越深，访问所需时间就越长。由于全局变量总处在作用域链的最末端，因此访问速度也最慢。
3.避免使用with语句，因为它会改变运行期上下文作用域链。同样，try-catch语句中的catch子句也有同样的影响，因此也要小心使用。
4.嵌套的对象成员会明显影响性能，尽量少用。
5.属性或方法在原型链中的位置越深，访问它的速度也越慢。
6.通常来说，你可以通过把常用的对象成员、数组元素、跨域变量保存在局部变量中来改善Javascript性能，因为局部变量访问速度更快。






