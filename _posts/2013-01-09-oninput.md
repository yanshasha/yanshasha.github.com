---
layout: post
title: "oninput"
description: ""
category: 
tags: []
---
{% include JB/setup %}

###使用场景
 很多情况下我们都会即时监听输入框值的变化，以便作出即时动作去引导浏览者增强网站的用户体验感。比如这次，在手机上需要对textarea进行监听，每次当里面文字改变（可能是手机键盘输入，粘贴，回退删除等）时，在textarea的右下角记录当前框里的文字。

###问题
开始我尝试用常规的onkeyup来监听，但是后来发现这种情况当使用中文输入法或者粘贴进文字时，事件没有触发，导致文字计算不正确。

###解决方案
传统对于文本框（input）的输入可通过键盘的 onkeydown / onkeypress / onkeyup 来监测，但在处理较多细节时存在诟病,比如： cut（剪切） / paste（复制） / undo（撤销） / redo（重做） / drag & drop（拖拽）/ 输入法等。

而 oninput & onpropertychange 事件基本可以解决上面的诟病：

oninput 事件作为 HTML5 中的标准事件，基本除了IE6 / IE7 / IE8 外的最新浏览器均支持（注：1、原先的 Opera 的虽支持，但依然存在部分传统的诟病，从 Opera 11+ 开始，已修复，更加完美；2、IE9 也支持）。

	function(input, callback){
	    if ("onpropertychange" in input) { //IE6/IE7/IE8
	        input.onpropertychange = function(){
	            if (window.event.propertyName == "value"){
	                callback.call(this, window.event)
	            }
	        }
	    } else {
	        // Fix Firefox Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=195696
	        input.addEventListener("input", callback, false);
	    }
	}
	
提示：
* oninput 事件：当 JS 改变 value 值或从浏览器的自动下拉提示中选值时，不会触发。
* onpropertychange 事件：当 input 设置为不可用（disable=true）时，不会触发。

###概述

window对象上input事件的事件句柄,当`<input>` 元素的value属性值由输入设备改变时,就会触发input事件.

该事件是冒泡的.除了在window对象上, `<input>`文本框元素也有input事件.

###例子

	<script>
	
	window.addEventListener('input',function(e){
	 console.log("检测到input事件!来自这个元素:", e.target);
	}, false);
	
	</script>
	
	<input placeholder="在这里输入文字,并查看控制台">


<table> 
	<tbody> 
		<tr>
			 <th>Feature</th> 
			 <th>Chrome</th> 
			 <th>Firefox (Gecko)</th> 
			 <th>Internet Explorer</th> 
			 <th>Opera</th> 
			 <th>Safari</th> 
		 </tr> 
		 <tr> 
			 <td>Basic support</td> 
			 <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td> 
			 <td>2</td> 
			 <td>9</td> 
			 <td>10</td> 
			 <td><span style="color: #888;" title="Please update this with the earliest version of support.">(Yes)</span></td> 
		 </tr> 
	 </tbody> 
 </table>

###注意
oninput的功能并不完全等于onpropertychange，onpropertychange并没有监听到回删，剪切等功能，所以后来在测试winphone的时候出现了问题，最后在绑定onpropertychange的同时绑定onkeyup解决。

参考：
1. [哥俩好：oninput & onpropertychange](http://www.planabc.net/2011/10/18/oninput_and_onpropertychange/)
2. [window.oninput](https://developer.mozilla.org/zh-CN/docs/DOM/window.oninput)




























